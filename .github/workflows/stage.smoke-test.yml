name: Smoke Test Stage

on:
  workflow_call:
    inputs:
      change-id:
        required: true
        type: string
        description: "PR number or change identifier"
      preview-urls:
        required: true
        type: string
        description: "Base64-encoded JSON of preview URLs"
      is-pr:
        required: false
        type: boolean
        default: false
        description: "Whether this is a PR (enables PR comment)"
      runner-group:
        required: false
        type: string
        description: "GitHub Actions runner group"
        default: "azure-nonprod"

jobs:
  pr-comment:
    name: PR Comment
    if: inputs.is-pr
    uses: ./.github/workflows/job.pr-comment.yml
    with:
      change-id: ${{ inputs.change-id }}
      preview-urls: ${{ inputs.preview-urls }}

  smoke-test:
    name: Smoke Test
    uses: ./.github/workflows/job.smoke-test.yml
    with:
      preview-urls: ${{ inputs.preview-urls }}
      runner-group: ${{ inputs.runner-group }}
