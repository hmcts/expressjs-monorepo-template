{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["config:recommended"],
  "automerge": true,
  "node": {
    "enabled": true
  },
  "regexManagers": [
    {
      "description": "Update Node.js version in .nvmrc",
      "fileMatch": ["^\\.nvmrc$"],
      "matchStrings": ["(?<currentValue>.*?)\\n"],
      "depNameTemplate": "node",
      "datasourceTemplate": "node-version",
      "versioningTemplate": "node"
    },
    {
      "description": "Update Node.js version in Dockerfiles",
      "fileMatch": ["(^|/)Dockerfile[^/]*$"],
      "matchStrings": [
        "FROM node:(?<currentValue>[0-9]+(?:\\.[0-9]+)?(?:\\.[0-9]+)?)-(?<currentVariant>alpine|slim|bullseye|bookworm)(?:\\s|$)"
      ],
      "depNameTemplate": "node",
      "datasourceTemplate": "docker",
      "packageNameTemplate": "node",
      "versioningTemplate": "node"
    },
    {
      "description": "Update Node.js version in GitHub Actions",
      "fileMatch": ["^\\.github/workflows/.*\\.ya?ml$"],
      "matchStrings": [
        "node-version:\\s*['\"]?(?<currentValue>[0-9]+(?:\\.[0-9]+)?(?:\\.[0-9]+)?)['\"]?"
      ],
      "depNameTemplate": "node",
      "datasourceTemplate": "node-version",
      "versioningTemplate": "node"
    }
  ],
  "packageRules": [
    {
      "description": "Group all Node.js version updates",
      "groupName": "Node.js version",
      "matchPackageNames": ["node"],
      "matchManagers": ["regex", "nvm"],
      "matchDatasources": ["node-version", "docker"],
      "enabled": true
    },
    {
      "description": "Auto-merge Node.js minor and patch updates",
      "matchPackageNames": ["node"],
      "matchUpdateTypes": ["minor", "patch"],
      "automerge": true
    },
    {
      "description": "Require approval for Node.js major updates",
      "matchPackageNames": ["node"],
      "matchUpdateTypes": ["major"],
      "automerge": false
    }
  ],
  "constraints": {
    "node": ">=22"
  }
}
