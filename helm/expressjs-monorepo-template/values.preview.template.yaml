# Global values shared by all subcharts
global:
  environment: preview
  security:
    allowInsecureImages: true

# Enable/disable subcharts
web:
  enabled: true
api:
  enabled: true
crons:
  enabled: true

# Web application configuration
expressjs-monorepo-template-web:
  nodejs:
    image: "hmctspublic.azurecr.io/dtsse/expressjs-monorepo-template-web:${WEB_IMAGE}"
    ingressHost: "${TEAM_NAME}-{{ .Release.Name }}-web.preview.platform.hmcts.net"
    environment:
      REDIS_URL: "redis://{{ .Release.Name }}-redis-master:6379"

# API application configuration
expressjs-monorepo-template-api:
  nodejs:
    image: "hmctspublic.azurecr.io/dtsse/expressjs-monorepo-template-api:${API_IMAGE}"
    ingressHost: "${TEAM_NAME}-{{ .Release.Name }}-api.preview.platform.hmcts.net"

# Crons application configuration
expressjs-monorepo-template-crons:
  job:
    image: "hmctspublic.azurecr.io/dtsse/expressjs-monorepo-template-crons:${CRONS_IMAGE}"
    schedule: "*/5 * * * *"  # Every 5 minutes
    suspend: false
    kind: CronJob
    environment:
      SCRIPT_NAME: "index.js"

# PostgreSQL database configuration
postgresql:
  enabled: true
  flexibleserver: dtsse-dashboard-flexdb-data-aat
  setup:
    databases:
      - name: "{{ .Release.Name }}"

# Redis cache configuration
redis:
  enabled: true
  architecture: standalone
  master:
    persistence:
      enabled: false
    auth:
      enabled: false
  replica:
    replicaCount: 0
  image:
    registry: hmctspublic.azurecr.io
    repository: imported/bitnami/redis
